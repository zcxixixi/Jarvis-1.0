    def _speaker_worker(self):
        """
        [ä¸“ç”¨æ’­æ”¾çº¿ç¨‹] å……å½“ Jitter Bufferï¼Œå¹³æ»‘ç½‘ç»œæ³¢åŠ¨ï¼Œé˜²æ­¢é˜»å¡ä¸»å¾ªç¯
        æ¶ˆè´¹è€…ï¼šè´Ÿè´£ä»é˜Ÿåˆ—è·å– -> è½¬æ¢ -> å†™å…¥å£°å¡ -> å–‚ç»™ AEC
        """
        import audioop
        print("ğŸ§µ [THREAD] Speaker Worker starting...")
        
        chunk_count = 0
        while self.is_running:
            try:
                # é˜»å¡ç­‰å¾…éŸ³é¢‘æ•°æ®
                data = self.speaker_queue.get(timeout=1.0)
                if data is None: 
                    # print("[AUDIO] Received None chunk (End of Session)")
                    continue 
                
                # [DEBUG] åªè¦é˜Ÿåˆ—æœ‰æ•°æ®ï¼Œå°±ç«‹åˆ»æ‰“å°
                # print(f"[AUDIO] Popped {len(data)} bytes from queue")

                # --- [FIX] Upsampling & Mono-to-Stereo ---
                try:
                    # 1. é‡é‡‡æ ·: 24k -> 48k (Mac ç¡¬ä»¶åŸç”Ÿæ›´ç¨³å®š)
                    upsampled_data, self.output_upsample_state = audioop.ratecv(
                        data, 2, 1, 24000, 48000, self.output_upsample_state
                    )
                    
                    # 2. è½¬ç«‹ä½“å£°: Mono -> Stereo (1ch -> 2ch)
                    stereo_data = audioop.tostereo(upsampled_data, 2, 1, 1)
                    
                    # 3. å†™å…¥å£°å¡
                    # print(f"[AUDIO] Writing to hardware...")
                    self.output_stream.write(stereo_data, exception_on_underflow=False)
                    
                    chunk_count += 1
                    if chunk_count % 10 == 0:
                        print(f"[AUDIO] ğŸ”Š Playing chunk {chunk_count}... (Queue: {self.speaker_queue.qsize()})")

                except Exception as e:
                    print(f"[AUDIO] âŒ Hardware playback error: {e}")

                # æ›´æ–°æœ€åæ’­æ”¾æ—¶é—´
                self.last_audio_time = time.time()

                # --- AEC Reference Feeding (Feed 16k mono for AEC) ---
                try:
                    ref_chunk, self.ref_resample_state = audioop.ratecv(
                        data, 2, 1, 24000, 16000, self.ref_resample_state
                    )
                    self.aec.feed_reference(ref_chunk)
                except: pass
                
                self.speaker_queue.task_done()
            except queue.Empty:
                continue
            except Exception as e:
                print(f"[AUDIO] âŒ Worker loop error: {e}")
